<ik-header [title]="'Create Guardian'"
  ><ik-header-back (back)="onCancelClick()"></ik-header-back>
  <button
    class="btn btn-primary btn-flat btn-header-right"
    [disabled]="loading"
    (click)="onExistingUserClick()"
  >
    <ik-icon icon="pen-to-square" classOverride="btn-icon"></ik-icon>
    Existing User?
  </button>
</ik-header>

<app-guardian-form
  *ngIf="!loading; else pageLoader"
  [disableSave]="disableSave"
  rightActionButton="Save Guardian"
  leftActionButton="Cancel"
  (cancel)="onCancelClick()"
  (save)="onSaveClick($event)"
>
</app-guardian-form>

<ng-template #pageLoader>
  <ik-loading type="double"></ik-loading>
</ng-template>

<ik-modal #duplicateGuardianModal name="duplicateGuardianModal">
  <ik-modal-header title="Duplicate Guardian?" type="warning"></ik-modal-header>
  <ik-modal-body>
    <div>
      There is already a guardian in the church directory with similar
      information. The guardian below is the one currently in the church system.
      If this is not the same guardian, then you can click 'Continue' to create
      the guardian. Otherwise if this is the same guardian you can hit 'Cancel'.
    </div>
    <div class="row">
      <ik-card-info
        class="col-6"
        header="Name"
        [text]="duplicateGuardian | formatUserName"
      ></ik-card-info>
      <ik-card-info
        class="col-6"
        header="Phone"
        [text]="duplicateGuardian?.phone"
      ></ik-card-info>
    </div>
    <div class="row">
      <ik-card-info
        class="col-6"
        header="Email"
        [text]="duplicateGuardian?.email"
      ></ik-card-info>
      <ik-card-info
        class="col-6"
        header="Address"
        [text]="duplicateGuardian | address"
      ></ik-card-info>
    </div>
    <div class="row">
      <ik-card-info class="col-6" header="More Details">
        <a
          [href]="'/guardians/' + duplicateGuardian?.id + '/details'"
          target="_blank"
          class="link card-info__label-text"
          >{{ duplicateGuardian | formatUserName }}</a
        ></ik-card-info
      >
    </div>
  </ik-modal-body>
  <ik-modal-action-bar>
    <button
      class="btn btn-warning btn-flat btn-right btn-modal"
      (click)="onDuplicateGuardianAcknowledgement()"
    >
      Continue
    </button>
    <button
      class="btn btn-default btn-flat btn-right btn-modal"
      (click)="duplicateGuardianModal.close()"
    >
      Cancel
    </button>
  </ik-modal-action-bar>
</ik-modal>
